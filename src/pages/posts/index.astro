---
import Layout from "../../layouts/Layout.astro";
import BackHome from "../../components/BackHome.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("posts")).sort((a, b) => b.data.date.localeCompare(a.data.date));

const formatDate = (iso) =>
  new Date(`${iso}T00:00:00`).toLocaleDateString("en-US", {
    year: "numeric",
    month: "short",
    day: "numeric",
  });
---

<Layout title="Posts">
  <main class="min-h-screen px-6 py-16">
    <div class="mx-auto max-w-2xl">
      <BackHome />

      <h1 class="text-2xl sm:text-3xl font-semibold tracking-tight text-neutral-50">
        Posts
      </h1>

      <ul class="mt-8 divide-y divide-neutral-800">
        {posts.map((post) => (
          <li>

            <a href={`/posts/${post.slug}`} class="group block py-4">
              <div class="flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between sm:gap-6">
                <!-- LEFT -->
                <div class="min-w-0">
                  <!-- title row -->
                  <div class="flex items-start gap-3">
                    <!-- arrow (desktop only) -->
                    <span
                      class="hidden sm:inline mt-1 text-neutral-400 opacity-0 -translate-x-1
                             transition-all duration-200
                             group-hover:opacity-100 group-hover:translate-x-0"
                      aria-hidden="true"
                    >
                      â†’
                    </span>

                    <!-- title + date stacked -->
                    <div>
                      <div class="text-base sm:text-lg text-neutral-300">
                        {post.data.title}
                      </div>

                      <!-- date: always directly under title -->
                      <div class="mt-0.5 text-xs text-neutral-500">
                        {formatDate(post.data.date)}
                      </div>
                    </div>
                  </div>
                </div>

                <!-- RIGHT: tags -->
                {post.data.tags?.length ? (
                  <div class="flex flex-wrap gap-2">
                    {post.data.tags.map((t) => (
                      <span
                        class="rounded-full border border-neutral-700 bg-neutral-800
                               px-2 py-0.5 text-xs text-neutral-300"
                      >
                        {t}
                      </span>
                    ))}
                  </div>
                ) : null}
              </div>
            </a>
          
          </li>
        ))}
      </ul>

    </div>
  </main>
</Layout>
